/**
 * Form Interactions Component Styles
 * Styles for enhanced form interaction utilities
 */

// Form Toggle Container
.form-toggle-container {
    position: relative;

    // Smooth transitions for mode switching
    .form-display,
    .form-edit {
        transition: opacity 0.3s ease, transform 0.2s ease;
    }

    // View mode styles
    &.view-mode {
        .form-display {
            display: block;
            opacity: 1;
        }

        .form-edit {
            display: none;
            opacity: 0;
        }
    }

    // Edit mode styles
    &.edit-mode {
        .form-display {
            display: none;
            opacity: 0;
        }

        .form-edit {
            display: block;
            opacity: 1;
        }
    }

    // Form toggle buttons
    .form-toggle-btn,
    .form-save-btn,
    .form-cancel-btn {
        transition: all 0.2s ease;

        &:hover {
            transform: translateY(-1px);
        }

        &:active {
            transform: translateY(0);
        }
    }

    // Empty state styling
    .form-display.empty {
        color: var(--bs-gray-500);
        font-style: italic;

        &::before {
            content: "未設定";
        }
    }
}

// Auto-calculation field styles
[data-auto-calculate],
.auto-calculated-field {
    position: relative;

    // Calculation indicator
    &.calculating {
        .calculation-spinner {
            position: absolute;
            top: 50%;
            right: 0.75rem;
            transform: translateY(-50%);
            color: var(--bs-primary);
            z-index: 10;

            .spin {
                animation: spin 1s linear infinite;
            }
        }

        input,
        .form-display {
            padding-right: 2.5rem;
        }
    }

    // Calculation error state
    &.calculation-error {

        input,
        .form-display {
            border-color: var(--bs-danger);
            background-color: rgba(var(--bs-danger-rgb), 0.1);
        }
    }

    // Calculation success animation
    .calculation-updated {
        animation: calculationPulse 0.6s ease;
    }
}

// Form validation enhancements
.form-group,
.mb-3 {
    &.has-error {
        .form-label {
            color: var(--bs-danger);
        }
    }
}

// Enhanced validation feedback
.invalid-feedback,
.valid-feedback {
    font-size: 0.875rem;
    margin-top: 0.25rem;
    transition: opacity 0.2s ease;
}

.invalid-feedback {
    color: var(--bs-danger);

    &::before {
        content: "⚠ ";
        margin-right: 0.25rem;
    }
}

.valid-feedback {
    color: var(--bs-success);

    &::before {
        content: "✓ ";
        margin-right: 0.25rem;
    }
}

// Form field enhancements
.form-control,
.form-select {
    &.is-invalid {
        border-color: var(--bs-danger);
        box-shadow: 0 0 0 0.2rem rgba(var(--bs-danger-rgb), 0.25);

        &:focus {
            border-color: var(--bs-danger);
            box-shadow: 0 0 0 0.2rem rgba(var(--bs-danger-rgb), 0.25);
        }
    }

    &.is-valid {
        border-color: var(--bs-success);
        box-shadow: 0 0 0 0.2rem rgba(var(--bs-success-rgb), 0.25);

        &:focus {
            border-color: var(--bs-success);
            box-shadow: 0 0 0 0.2rem rgba(var(--bs-success-rgb), 0.25);
        }
    }
}

// Smooth transition utilities
.fade-transition {
    transition: opacity 0.3s ease;

    &.fade-in {
        opacity: 1;
    }

    &.fade-out {
        opacity: 0;
    }
}

.slide-transition {
    transition: height 0.3s ease, opacity 0.3s ease;
    overflow: hidden;

    &.slide-down {
        height: auto;
        opacity: 1;
    }

    &.slide-up {
        height: 0;
        opacity: 0;
    }
}

// Keyboard shortcuts display
.keyboard-shortcuts {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 1rem;
    border-radius: 8px;
    font-size: 0.875rem;
    z-index: 1050;
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.3s ease, transform 0.3s ease;

    &.show {
        opacity: 1;
        transform: translateY(0);
    }

    .shortcut-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;

        &:last-child {
            margin-bottom: 0;
        }

        .key {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.75rem;
            margin-left: 1rem;
        }
    }

    @media (max-width: 768px) {
        display: none;
    }
}

// Animations
@keyframes spin {
    from {
        transform: rotate(0deg);
    }

    to {
        transform: rotate(360deg);
    }
}

@keyframes calculationPulse {
    0% {
        background-color: transparent;
    }

    50% {
        background-color: rgba(var(--bs-success-rgb), 0.2);
    }

    100% {
        background-color: transparent;
    }
}

// Responsive adjustments
@media (max-width: 768px) {
    .form-toggle-container {

        .form-toggle-btn,
        .form-save-btn,
        .form-cancel-btn {
            font-size: 0.875rem;
            padding: 0.375rem 0.75rem;
        }
    }

    [data-auto-calculate],
    .auto-calculated-field {
        &.calculating {
            .calculation-spinner {
                right: 0.5rem;
            }

            input,
            .form-display {
                padding-right: 2rem;
            }
        }
    }
}

// High contrast mode support
@media (prefers-contrast: high) {
    .form-toggle-container {
        .form-display.empty {
            color: var(--bs-gray-700);
            font-weight: 500;
        }
    }

    .invalid-feedback {
        font-weight: 600;
    }

    .valid-feedback {
        font-weight: 600;
    }
}

// Reduced motion support
@media (prefers-reduced-motion: reduce) {
    .form-toggle-container {

        .form-display,
        .form-edit {
            transition: none;
        }
    }

    [data-auto-calculate],
    .auto-calculated-field {
        .calculation-updated {
            animation: none;
            background-color: rgba(var(--bs-success-rgb), 0.2);
        }
    }

    .fade-transition,
    .slide-transition {
        transition: none;
    }

    .keyboard-shortcuts {
        transition: none;
    }
}