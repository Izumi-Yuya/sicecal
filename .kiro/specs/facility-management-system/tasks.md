# 実装計画

- [x] 1. プロジェクト基盤とフロントエンド環境の構築
  - Laravel 10.xプロジェクトの初期化
  - Bootstrap 5とフロントエンド開発環境のセットアップ
  - _要件: 全体的なシステム基盤_

- [ ] 2. フロントエンド・UI実装（優先実装）
- [x] 2.1 基本レイアウトとナビゲーションの構築
  - Bootstrap 5を使用したレスポンシブレイアウト
  - ヘッダー、サイドバー、フッターの共通レイアウト作成
  - _要件: 全般的なUI要件_

- [x] 2.2 ログイン・認証画面の作成
  - ログインフォームのデザインと実装
  - パスワードリセット画面の作成
  - _要件: 1.1, 1.2_

- [x] 2.3 ダッシュボード画面の実装
  - ロール別ダッシュボードレイアウト
  - 統計情報表示エリアの作成
  - _要件: 5.1-5.7_

- [ ] 2.4 施設一覧・検索画面の実装
  - 施設一覧テーブルとページネーション
  - 検索フィルター（都道府県、部門、地区）のUI
  - _要件: 2.1, 5.1-5.7_

- [ ] 2.5 施設詳細・編集画面の実装
  - 施設情報表示・編集フォーム
  - ロール別操作ボタンの表示制御
  - _要件: 2.1, 2.2, 5.1-5.7_

- [ ] 2.6 承認ワークフロー画面の実装
  - 承認待ち一覧画面
  - 承認・却下フォームとコメント機能
  - _要件: 4.1, 4.2, 4.3_

- [ ] 2.7 ファイル管理画面の実装
  - ファイルアップロード・ダウンロードUI
  - ドラッグ&ドロップ機能付きアップローダー
  - _要件: 3.1, 3.3_

- [ ] 2.8 データ出力・レポート画面の実装
  - CSV/PDF出力設定画面
  - お気に入り出力設定管理画面
  - _要件: 6.1, 6.2, 6.3_

- [ ] 2.9 修繕履歴管理画面の実装
  - 修繕履歴一覧・登録・編集フォーム
  - 時系列表示とフィルター機能
  - _要件: 7.1, 7.2_

- [ ] 2.10 年次確認・コメント機能画面の実装
  - 年次確認フォームと相違報告画面
  - コメント投稿・対応状況表示画面
  - _要件: 8.1, 8.2, 9.1, 9.3_

- [ ] 2.11 管理者画面の実装
  - ユーザー管理画面
  - システムログ・監査画面
  - _要件: 1.4, 10.2_

- [ ] 2.12 JavaScript機能の実装
  - リアルタイムバリデーション
  - ファイルアップロード進捗表示
  - Ajax通信とSPA的な操作感の実装
  - _要件: 全般的なUX要件_

- [ ] 3. データベース設計と基本モデルの実装
- [ ] 3.1 マイグレーションファイルの作成
  - users, roles, departments, regions, facilitiesテーブルのマイグレーション作成
  - 基本的な外部キー制約とインデックスの設定
  - _要件: 1.1, 2.1, 5.1-5.7_

- [ ] 3.2 基本Eloquentモデルの実装
  - User, Role, Department, Region, Facilityモデルの作成
  - リレーション定義とバリデーションルールの実装
  - _要件: 1.1, 2.1, 5.1-5.7_

- [ ] 3.3 シーダーとファクトリーの作成
  - 基本データ（ロール、部門）のシーダー作成
  - テスト用ファクトリーの実装
  - _要件: 1.5, 5.1-5.7_

- [ ] 4. 認証・認可システムの実装
- [ ] 4.1 Laravel認証システムのセットアップ
  - Laravel Sanctumを使用した認証機能の実装
  - ログイン・ログアウト機能の作成
  - _要件: 1.1, 1.2_

- [ ] 4.2 IP制限ミドルウェアの実装
  - 社内IPアドレス制限のカスタムミドルウェア作成
  - 設定ファイルでのIP範囲管理機能
  - _要件: 1.3_

- [ ] 4.3 ロールベースアクセス制御の実装
  - Laravel Gates/Policiesを使用した権限制御
  - 各ロールに応じたアクセス制御ロジック
  - _要件: 1.4, 1.5, 5.1-5.7_

- [ ] 5. 施設情報管理機能の実装
- [ ] 5.1 施設CRUD操作の基本実装
  - 施設の登録・更新・削除機能の作成
  - バリデーション機能（郵便番号形式、重複チェック等）
  - _要件: 2.1, 2.2, 2.4, 2.5_

- [ ] 5.2 施設一覧・検索機能の実装
  - 施設一覧表示とページネーション
  - 都道府県・部門・地区による絞り込み検索機能
  - _要件: 2.1, 5.1-5.7_

- [ ] 5.3 施設詳細表示機能の実装
  - ロール別の操作ボタン表示制御
  - 関連情報（修繕履歴、ドキュメント等）の表示
  - _要件: 2.1, 5.1-5.7_

- [ ] 6. 承認ワークフローシステムの実装
- [ ] 5.1 承認モデルとワークフロー基盤の作成
  - Approvalモデルと承認状態管理の実装
  - 承認フロー制御ロジックの作成
  - _要件: 4.1, 4.2, 4.4, 4.5_

- [ ] 5.2 承認申請機能の実装
  - 施設情報変更時の承認申請処理
  - 変更前後データの記録機能
  - _要件: 2.2, 4.1_

- [ ] 5.3 承認・却下機能の実装
  - 承認者による承認・却下処理
  - コメント機能と通知システム
  - _要件: 4.2, 4.3, 4.5_

- [ ] 6. ファイル管理システムの実装
- [ ] 6.1 AWS S3連携とファイルアップロード機能
  - S3バケット設定とLaravel Storage設定
  - PDFファイルアップロード機能の実装
  - _要件: 3.1, 3.2_

- [ ] 6.2 ファイルダウンロードとアクセス制御
  - 権限に基づくファイルアクセス制御
  - 署名付きURLによる安全なダウンロード機能
  - _要件: 3.3, 3.4_

- [ ] 6.3 ファイルバージョン管理機能
  - ファイル更新時のバージョン履歴管理
  - 3年間保管要件に対応した保持期間管理
  - _要件: 3.2, 3.5_

- [ ] 7. データ出力・レポート機能の実装
- [ ] 7.1 CSV出力機能の実装
  - UTF-8 with BOM形式でのCSV出力
  - 項目選択機能とカスタム出力設定
  - _要件: 6.1, 6.4_

- [ ] 7.2 PDF帳票出力機能の実装
  - 承認済み情報のみを含むPDF生成
  - 改ざん防止機能付き帳票作成
  - _要件: 6.2_

- [ ] 7.3 お気に入り出力設定機能の実装
  - ユーザーごとの出力設定保存機能（最大10件）
  - 出力設定の管理・削除機能
  - _要件: 6.3_

- [ ] 8. 修繕履歴管理機能の実装
- [ ] 8.1 修繕履歴CRUD機能の作成
  - 修繕履歴の登録・更新・削除機能
  - 施設との関連付けと権限制御
  - _要件: 7.1, 7.3, 7.4, 7.5_

- [ ] 8.2 修繕履歴表示・検索機能の実装
  - 時系列での修繕履歴表示
  - 期間・種別による検索機能
  - _要件: 7.2, 7.5_

- [ ] 9. 年次情報確認機能の実装
- [ ] 9.1 年次確認通知システムの作成
  - 年次確認期間の自動通知機能
  - 施設管理者への確認依頼送信
  - _要件: 8.1, 8.5_

- [ ] 9.2 年次確認回答・管理機能の実装
  - 施設管理者による確認・相違報告機能
  - 確認完了ステータスの追跡機能
  - _要件: 8.2, 8.3, 8.4_

- [ ] 10. コメント・通知システムの実装
- [ ] 10.1 コメント機能の基本実装
  - 閲覧者によるコメント投稿機能
  - 一次対応者への通知機能
  - _要件: 9.1, 9.2_

- [ ] 10.2 コメント対応・ステータス管理機能
  - 編集者による回答・ステータス更新機能
  - 解決通知とフォローアップ機能
  - _要件: 9.3, 9.4, 9.5_

- [ ] 11. システムログ・監査機能の実装
- [ ] 11.1 監査ログシステムの構築
  - 全ユーザーアクションの自動ログ記録
  - ログデータの構造化と検索機能
  - _要件: 10.1, 10.3_

- [ ] 11.2 管理者向けログ閲覧機能の実装
  - 検索可能な監査証跡の提供
  - セキュリティイベントの可視化
  - _要件: 10.2, 10.4, 10.5_

- [ ] 12. 定例会・会議サポート機能の実装
- [ ] 12.1 会議スケジュール管理機能の作成
  - 定例会スケジュールの登録・管理機能
  - 参加者への事前通知機能
  - _要件: 11.1, 11.5_

- [ ] 12.2 会議用レポート生成機能の実装
  - 部門別施設情報レポートの自動生成
  - 承認済み情報のみを含むレポート作成
  - _要件: 11.1, 11.2_

- [ ] 13. 契約・保険期限管理機能の実装
- [ ] 13.1 契約期限監視システムの構築
  - 契約・保険期限の自動チェック機能
  - 期限前アラート通知システム
  - _要件: 12.1, 12.2, 12.4_

- [ ] 13.2 期限管理ダッシュボードの実装
  - 期限切れ契約の警告表示
  - 期限順ソート機能付き一覧表示
  - _要件: 12.3, 12.4_

- [ ] 14. 施設稼働状況管理機能の実装
- [ ] 14.1 稼働状況データ管理機能の作成
  - 定員・利用者数入力と稼働率自動計算
  - 承認ワークフロー連携機能
  - _要件: 13.1, 13.5_

- [ ] 14.2 稼働率レポート・分析機能の実装
  - 月次・年次稼働率レポート生成
  - 地区・部門別比較レポート機能
  - _要件: 13.2, 13.3, 13.4_



- [ ] 15. テスト実装
- [ ] 15.1 単体テストの作成
  - 全モデルとサービスクラスの単体テスト
  - バリデーション機能のテスト
  - _要件: 全機能の品質保証_

- [ ] 15.2 機能テストの作成
  - 認証・認可フローのテスト
  - CRUD操作と承認ワークフローのテスト
  - _要件: 全機能の統合テスト_

- [ ] 16. セキュリティ・パフォーマンス最適化
- [ ] 16.1 セキュリティ強化の実装
  - CSRF保護とXSS対策の強化
  - SQLインジェクション対策の確認
  - _要件: セキュリティ要件全般_

- [ ] 16.2 パフォーマンス最適化の実装
  - データベースクエリ最適化
  - キャッシュ機能の実装
  - _要件: パフォーマンス要件_

- [ ] 17. 本番環境デプロイ準備
- [ ] 17.1 AWS環境構築とCI/CD設定
  - EC2、RDS、S3の本番環境構築
  - GitHub Actionsを使用したCI/CDパイプライン
  - _要件: 運用・保守要件_

- [ ] 17.2 本番データ移行とシステム統合
  - 既存Excelデータの移行スクリプト作成
  - システム統合テストと最終調整
  - _要件: データ移行要件_